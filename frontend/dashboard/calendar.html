<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hakkında - MentoriAI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
    <script src="./components/include.js"></script>
    <script src="diary.js"></script>
    <script src="./js/header.js"></script>
  </head>
  <body class="bg-white text-gray-800">
    <!-- Header -->
    <div data-include="components/header.html"></div>

    <main class="max-w-5xl mx-auto mt-16 p-6 bg-white rounded-lg shadow-md">
      <h1 class="text-3xl font-semibold text-[#E84230] mb-8 text-center">
        Takvim
      </h1>

      <!-- Takvim ve Görevler Bölümü -->
      <div class="flex flex-col md:flex-row gap-6">
        <!-- Takvim Görünümü -->
        <section class="flex-1 bg-gray-50 p-4 rounded-lg shadow">
          <div id="calendar" class="select-none">
            <!-- Buraya takvim takvimi JS ile eklenecek -->
          </div>
        </section>

        <!-- Günlük Görev Listesi -->
        <section
          class="w-full md:w-80 bg-gray-50 p-4 rounded-lg shadow flex flex-col"
        >
          <h2 class="text-xl font-semibold text-[#E84230] mb-4">
            Seçilen Günün Görevleri
          </h2>
          <ul id="taskList" class="flex-grow overflow-y-auto space-y-2">
            <li class="p-2 bg-white rounded border border-gray-300">
              Görev yok
            </li>
          </ul>
          <input
            id="newTaskInput"
            type="text"
            placeholder="Yeni görev ekle..."
            class="border border-gray-300 rounded px-3 py-2 mt-4 focus:outline-none focus:ring-2 focus:ring-[#E84230]"
          />
          <button
            id="addTaskBtn"
            class="mt-2 bg-[#E84230] text-white rounded px-4 py-2 hover:bg-[#c53623] transition"
          >
            Ekle
          </button>
        </section>
      </div>
    </main>

    <!-- Basit Takvim ve Görev Ekleme için JavaScript (Footer veya ayrı dosyada) -->
    <script>
      const calendarEl = document.getElementById('calendar');
      const taskListEl = document.getElementById('taskList');
      const newTaskInput = document.getElementById('newTaskInput');
      const addTaskBtn = document.getElementById('addTaskBtn');

      // Basit takvim için günleri oluştur
      let selectedDate = new Date();
      let tasks = {}; // { '2025-08-02': ['Görev 1', 'Görev 2'], ... }

      function formatDate(date) {
        return date.toISOString().split('T')[0];
      }

      function renderCalendar() {
        const year = selectedDate.getFullYear();
        const month = selectedDate.getMonth();

        // Ayın ilk günü ve son günü
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);

        let html = `<div class="flex justify-between items-center mb-4">
      <button id="prevMonth" class="px-3 py-1 rounded hover:bg-[#E84230] hover:text-white transition">&lt;</button>
      <h3 class="text-lg font-semibold">${year} - ${month + 1}</h3>
      <button id="nextMonth" class="px-3 py-1 rounded hover:bg-[#E84230] hover:text-white transition">&gt;</button>
    </div>`;

        html +=
          '<div class="grid grid-cols-7 gap-1 text-center text-sm font-semibold text-gray-600 mb-2">';
        ['Pzt', 'Sal', 'Çar', 'Per', 'Cum', 'Cts', 'Paz'].forEach((day) => {
          html += `<div>${day}</div>`;
        });
        html += '</div>';

        html += '<div class="grid grid-cols-7 gap-1">';

        // İlk haftada boşluk bırak
        for (let i = 0; i < firstDay.getDay() - 1; i++) {
          html += `<div></div>`;
        }

        // Günleri yazdır
        for (let d = 1; d <= lastDay.getDate(); d++) {
          const currentDate = new Date(year, month, d);
          const isoDate = formatDate(currentDate);
          const isSelected = formatDate(selectedDate) === isoDate;
          const hasTasks = tasks[isoDate]?.length > 0;

          html += `<div class="cursor-pointer p-2 rounded ${
            isSelected
              ? 'bg-[#E84230] text-white font-semibold'
              : 'hover:bg-[#E84230]/20'
          } ${
            hasTasks ? 'border-2 border-[#E84230]' : 'border'
          }" data-date="${isoDate}">
        ${d}
      </div>`;
        }

        html += '</div>';
        calendarEl.innerHTML = html;

        // Ay değiştir butonları
        document.getElementById('prevMonth').onclick = () => {
          selectedDate = new Date(year, month - 1, 1);
          renderCalendar();
          renderTasks();
        };

        document.getElementById('nextMonth').onclick = () => {
          selectedDate = new Date(year, month + 1, 1);
          renderCalendar();
          renderTasks();
        };

        // Gün seçme
        calendarEl.querySelectorAll('[data-date]').forEach((el) => {
          el.onclick = () => {
            selectedDate = new Date(el.getAttribute('data-date'));
            renderCalendar();
            renderTasks();
          };
        });
      }

      function renderTasks() {
        const isoDate = formatDate(selectedDate);
        const dayTasks = tasks[isoDate] || [];

        if (dayTasks.length === 0) {
          taskListEl.innerHTML =
            '<li class="p-2 bg-white rounded border border-gray-300">Görev yok</li>';
        } else {
          taskListEl.innerHTML = dayTasks
            .map(
              (task) =>
                `<li class="p-2 bg-white rounded border border-gray-300">${task}</li>`
            )
            .join('');
        }
      }

      addTaskBtn.onclick = () => {
        const val = newTaskInput.value.trim();
        if (!val) return;
        const isoDate = formatDate(selectedDate);

        if (!tasks[isoDate]) tasks[isoDate] = [];
        tasks[isoDate].push(val);
        newTaskInput.value = '';
        renderTasks();
        renderCalendar();
      };

      // Başlangıçta takvimi ve görevleri yükle
      renderCalendar();
      renderTasks();
    </script>

    <!-- Footer -->
    <div data-include="components/footer.html"></div>
  </body>
</html>
